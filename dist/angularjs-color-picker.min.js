/*!
 * angularjs-color-picker v1.0.1
 * https://github.com/ruhley/angular-color-picker/
 *
 * Copyright 2016 ruhley
 *
 * 2016-02-11 09:43:17
 *
 */
"undefined"!=typeof module&&"undefined"!=typeof exports&&module.exports===exports&&(module.exports="color.picker"),function(){"use strict";angular.module("color.picker",[])}(),function(){"use strict";var o=function(o,e){return{restrict:"E",require:["^ngModel"],scope:{ngModel:"=",showColorPicker:"=",colorPickerAlpha:"=",colorPickerCase:"=",colorPickerFormat:"=",colorPickerPos:"=",colorPickerSwatch:"=",colorPickerSwatchOnly:"=",colorPickerSwatchPos:"=",colorPickerSwatchBootstrap:"=",colorPickerOnChange:"&"},templateUrl:"template/color-picker/directive.html",link:function(c,t,i,n){c.onChangeValue=null,c.init=function(){if(void 0===c.ngModel)c.hue=0,c.saturation=0,c.lightness=100;else{var e=tinycolor(c.ngModel);if(e.isValid()){var t=e.toHsv();c.hue=t.h,c.saturation=100*t.s,c.lightness=100*t.v,c.opacity=100*t.a}}c.initConfig(),o.on("mousedown",c.onMouseDown),o.on("mouseup",c.onMouseUp),o.on("mousemove",c.onMouseMove),c.find(".color-picker-grid").on("click",c.onColorClick),c.find(".color-picker-hue").on("click",c.onHueClick),c.find(".color-picker-opacity").on("click",c.onOpacityClick)},c.onMouseDown=function(o){c.find(o.target).length>0&&(o.target.classList.contains("color-picker-grid-inner")||o.target.classList.contains("color-picker-picker")||o.target.parentNode.classList.contains("color-picker-picker")?(c.colorDown(o),c.$apply()):o.target.classList.contains("color-picker-hue")||o.target.parentNode.classList.contains("color-picker-hue")?(c.hueDown(o),c.$apply()):(o.target.classList.contains("color-picker-opacity")||o.target.parentNode.classList.contains("color-picker-opacity"))&&(c.opacityDown(o),c.$apply()))},c.onMouseUp=function(o){c.colorMouse||c.hueMouse||c.opacityMouse||0!==c.find(o.target).length?c.colorMouse?(c.colorUp(o),c.$apply(),c.onChange(o)):c.hueMouse?(c.hueUp(o),c.$apply(),c.onChange(o)):c.opacityMouse&&(c.opacityUp(o),c.$apply(),c.onChange(o)):c.log("Color Picker: Document Click Event")},c.onMouseMove=function(o){c.colorMouse?(c.colorChange(o),c.$apply()):c.hueMouse?(c.hueChange(o),c.$apply()):c.opacityMouse&&(c.opacityChange(o),c.$apply())},c.onColorClick=function(o){c.colorChange(o),c.$apply(),c.onChange(o)},c.onHueClick=function(o){c.hueChange(o),c.$apply(),c.onChange(o)},c.onOpacityClick=function(o){c.opacityChange(o),c.$apply(),c.onChange(o)},c.onChange=function(o){c.ngModel!==c.onChangeValue&&(c.onChangeValue=c.ngModel,c.colorPickerOnChange({$event:o,color:c.ngModel}))},c.initConfig=function(){c.config={},c.config.alpha=void 0===c.colorPickerAlpha?!0:c.colorPickerAlpha,c.config["case"]=void 0===c.colorPickerCase?"upper":c.colorPickerCase,c.config.format=void 0===c.colorPickerFormat?"hsl":c.colorPickerFormat,c.config.pos=void 0===c.colorPickerPos?"bottom left":c.colorPickerPos,c.config.swatch=void 0===c.colorPickerSwatch?!0:c.colorPickerSwatch,c.config.swatchOnly=void 0===c.colorPickerSwatchOnly?!1:c.colorPickerSwatchOnly,c.config.swatchPos=void 0===c.colorPickerSwatchPos?"left":c.colorPickerSwatchPos,c.config.swatchBootstrap=void 0===c.colorPickerSwatchBootstrap?!0:c.colorPickerSwatchBootstrap,c.log("Color Picker: Config",c.config)},c.focus=function(){c.log("Color Picker: Focus Event"),c.find(".color-picker-input")[0].focus()},c.show=function(){c.log("Color Picker: Show Event"),c.visible=!0,c.hueMouse=!1,c.opacityMouse=!1,c.colorMouse=!1,c.saturationUpdate(),c.lightnessUpdate()},c.hide=function(){(c.visible||null!==t[0].querySelector(".color-picker-panel").offsetParent)&&(c.log("Color Picker: Hide Event"),c.visible=!1)},c.close=function(){e.$broadcast("toggleColorpicker")},c.$watch("showColorPicker",function(o,e){void 0!==o&&(o?c.show():c.hide())}),c.update=function(){if(void 0!==c.hue&&void 0!==c.saturation&&void 0!==c.lightness){var o,e=tinycolor({h:c.hue,s:c.saturation/100,v:c.lightness/100});switch(c.config.alpha&&e.setAlpha(c.opacity/100),c.log("Color Picker: COLOR CHANGED TO ",e,c.hue,c.saturation,c.lightness,c.opacity),c.swatchColor=e.toHslString(),c.config.format){case"rgb":o=e.toRgbString();break;case"hex":o=e.toHexString(),o="lower"===c.config["case"]?o.toLowerCase():o.toUpperCase();break;case"hex8":o=e.toHex8String(),o="lower"===c.config["case"]?o.toLowerCase():o.toUpperCase();break;case"hsv":o=e.toHsvString();break;default:o=e.toHslString()}c.ngModel=o}},c.$watch("ngModel",function(o,e){if(void 0!==o&&null!==o&&o!==e&&o.length>4){c.log("Color Picker: MODEL - CHANGED",o);var t=tinycolor(o);if(t.isValid()){var r=t.toHsv();c.hue=r.h,c.saturation=100*r.s,c.lightness=100*r.v,c.config.alpha&&(c.opacity=100*r.a),c.isValid=!0}else c.isValid=!1;n[0].$setValidity(i.name,c.isValid),void 0!==e&&"function"==typeof n[0].$setDirty&&n[0].$setDirty()}else c.swatchColor=""}),c.$watch("colorPickerFormat",function(o,e){void 0!==o&&o!==e&&("hex"===o&&(c.colorPickerAlpha=!1),c.initConfig(),c.update())}),c.$watchGroup(["colorPickerAlpha","colorPickerCase"],function(o,e){void 0!==o&&(c.initConfig(),c.update())}),c.$watchGroup(["colorPickerSwatchPos","colorPickerSwatchBootstrap","colorPickerSwatchOnly","colorPickerSwatch","colorPickerPos"],function(o,e){void 0!==o&&c.initConfig()}),c.$watch("swatchColor",function(o){var e=angular.element(t[0].querySelector(".color-picker-swatch"));e.css({"background-color":o})}),c.$watch("huePos",function(o){var e=angular.element(t[0].querySelector(".color-picker-hue .color-picker-slider"));e.css({top:o+"%"})}),c.$watch("opacityPos",function(o){var e=angular.element(t[0].querySelector(".color-picker-opacity .color-picker-slider"));e.css({top:o+"%"})}),c.$watch("lightnessPos",function(o){var e=angular.element(t[0].querySelector(".color-picker-grid .color-picker-picker"));e.css({top:o+"%"})}),c.$watch("saturationPos",function(o){var e=angular.element(t[0].querySelector(".color-picker-grid .color-picker-picker"));e.css({left:o+"%"})}),c.$watch("grid",function(o){var e=angular.element(t[0].querySelector(".color-picker-grid"));e.css({"background-color":o})}),c.hueDown=function(o){o.stopPropagation(),o.preventDefault(),c.log("Color Picker: HUE - MOUSE DOWN"),c.hueMouse=!0},c.hueUp=function(o){o.stopPropagation(),o.preventDefault(),c.log("Color Picker: HUE - MOUSE UP"),c.hueMouse=!1},c.hueChange=function(o){o.stopPropagation(),o.preventDefault(),c.log("Color Picker: HUE - MOUSE CHANGE");var e=c.find(".color-picker-hue");c.hue=360*(1-(o.pageY-c.offset(e).top)/e.prop("offsetHeight")),c.hue>360?c.hue=360:c.hue<0&&(c.hue=0)},c.hueUpdate=function(){void 0!==c.hue&&(c.log("Color Picker: HUE - CHANGED"),c.huePos=100*(1-c.hue/360),c.grid=tinycolor({h:c.hue,s:100,v:1}).toHslString(),c.huePos<0?c.huePos=0:c.huePos>100&&(c.huePos=100),c.update())},c.$watch("hue",function(o,e){c.hueUpdate()}),c.opacityDown=function(o){o.stopPropagation(),o.preventDefault(),c.log("Color Picker: OPACITY - MOUSE DOWN"),c.opacityMouse=!0},c.opacityUp=function(o){o.stopPropagation(),o.preventDefault(),c.log("Color Picker: OPACITY - MOUSE UP"),c.opacityMouse=!1},c.opacityChange=function(o){o.stopPropagation(),o.preventDefault(),c.log("Color Picker: OPACITY - MOUSE CHANGE");var e=c.find(".color-picker-opacity");c.opacity=100*(1-(o.pageY-c.offset(e).top)/e.prop("offsetHeight")),c.opacity>100?c.opacity=100:c.opacity<0&&(c.opacity=0)},c.opacityUpdate=function(){void 0!==c.opacity&&(c.log("Color Picker: OPACITY - CHANGED"),c.opacityPos=100*(1-c.opacity/100),c.opacityPos<0?c.opacityPos=0:c.opacityPos>100&&(c.opacityPos=100),c.update())},c.$watch("opacity",function(o,e){c.opacityUpdate()}),c.colorDown=function(o){o.stopPropagation(),o.preventDefault(),c.log("Color Picker: COLOR - MOUSE DOWN"),c.colorMouse=!0},c.colorUp=function(o){o.stopPropagation(),o.preventDefault(),c.log("Color Picker: COLOR - MOUSE UP"),c.colorMouse=!1},c.colorChange=function(o){o.stopPropagation(),o.preventDefault(),c.log("Color Picker: COLOR - MOUSE CHANGE");var e=c.find(".color-picker-grid-inner"),t=c.offset(e);c.saturation=(o.pageX-t.left)/e.prop("offsetWidth")*100,c.lightness=100*(1-(o.pageY-t.top)/e.prop("offsetHeight")),c.saturation>100?c.saturation=100:c.saturation<0&&(c.saturation=0),c.lightness>100?c.lightness=100:c.lightness<0&&(c.lightness=0)},c.saturationUpdate=function(o){void 0!==c.saturation&&c.saturation!==o&&(c.log("Color Picker: SATURATION - CHANGED"),c.saturationPos=c.saturation/100*100,c.saturationPos<0?c.saturationPos=0:c.saturationPos>100&&(c.saturationPos=100),c.update())},c.$watch("saturation",function(o,e){c.saturationUpdate(e)}),c.lightnessUpdate=function(o){void 0!==c.lightness&&c.lightness!==o&&(c.log("Color Picker: LIGHTNESS - CHANGED"),c.lightnessPos=100*(1-c.lightness/100),c.lightnessPos<0?c.lightnessPos=0:c.lightnessPos>100&&(c.lightnessPos=100),c.update())},c.$watch("lightness",function(o,e){c.lightnessUpdate(e)}),c.log=function(){},c.find=function(o){var e,i=c.wrapper?c.wrapper[0]:t[0],n=[];if(!o)return n;if("string"==typeof o){if(1!==(e=i.nodeType)&&9!==e)return[];n=i.querySelectorAll(o)}else i.contains(o)&&n.push(o);return angular.element(n)},c.offset=function(o){var e,c,t,i,n=o[0];if(n)return n.getClientRects().length?(t=n.getBoundingClientRect(),t.width||t.height?(i=n.ownerDocument,c=null!==i&&i===i.window?i:9===i.nodeType&&i.defaultView,e=i.documentElement,window.chrome&&screen.width<=768?{top:t.top-e.clientTop,left:t.left-e.clientLeft}:{top:t.top+c.pageYOffset-e.clientTop,left:t.left+c.pageXOffset-e.clientLeft}):t):{top:0,left:0}},c.init(),c.$on("$destroy",function(){o.off("mousedown",c.onMouseDown),o.off("mouseup",c.onMouseUp),o.off("mousemove",c.onMouseMove)})}}};angular.module("color.picker").directive("colorPicker",["$document","$rootScope",o])}(),angular.module("color.picker").run(["$templateCache",function(o){o.put("template/color-picker/directive.html",'<div class="color-picker-wrapper" ng-class="{\'color-picker-swatch-only\': config.swatchOnly}">\n   <div class="color-picker-input-wrapper" ng-class="{\'input-group\': config.swatchBootstrap && config.swatch}">\n       <span ng-if="config.swatchPos === \'left\'" class="color-picker-swatch" ng-click="focus()" ng-show="config.swatch" ng-class="{\'color-picker-swatch-left\': config.swatchPos !== \'right\', \'color-picker-swatch-right\': config.swatchPos === \'right\', \'input-group-addon\': config.swatchBootstrap}"></span>\n       <input class="color-picker-input form-control" type="text" ng-model="ngModel" ng-change="onChange($event)" size="7" ng-focus="show()" ng-class="{\'color-picker-input-swatch\': config.swatch && !config.swatchOnly && config.swatchPos === \'left\'}">\n       <span ng-if="config.swatchPos === \'right\'" class="color-picker-swatch" ng-click="focus()" ng-show="config.swatch" ng-class="{\'color-picker-swatch-left\': config.swatchPos !== \'right\', \'color-picker-swatch-right\': config.swatchPos === \'right\', \'input-group-addon\': config.swatchBootstrap}"></span>\n   </div>\n   <div class="color-picker-panel" ng-show="visible" ng-class="{\n       \'color-picker-panel-top color-picker-panel-right\': config.pos === \'top right\',\n       \'color-picker-panel-top color-picker-panel-left\': config.pos === \'top left\',\n       \'color-picker-panel-bottom color-picker-panel-right\': config.pos === \'bottom right\',\n       \'color-picker-panel-bottom color-picker-panel-left\': config.pos === \'bottom left\',\n   }">\n       <span class="ion-reply"></span>\n       <span ng-click="close();" class="ion-close-circled"></span>\n       <div class="color-picker-hue color-picker-sprite">\n           <div class="color-picker-slider"></div>\n       </div>\n       <div class="color-picker-opacity color-picker-sprite" ng-show="config.alpha">\n           <div class="color-picker-slider"></div>\n           </div>\n       <div class="color-picker-grid color-picker-sprite">\n           <div class="color-picker-grid-inner"></div>\n           <div class="color-picker-picker">\n               <div></div>\n           </div>\n       </div>\n   </div>\n</div>')}]);